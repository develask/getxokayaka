var https = require('https');

function Flickr(api_key, api_secret){
    this.api_key = api_key;
    this.api_secret = api_secret;
}
Flickr.prototype.url= "https://api.flickr.com/services/rest/?method=";
Flickr.prototype.request = function(method, options, callback){
        var req = https.get('https://api.flickr.com/services/rest/?method='+method+options+"&format=json&nojsoncallback=1", function(response){
            var str = ''
            response.on('data', function (chunk) {
                str += chunk;
            });

            response.on('end', function () {
                callback(JSON.parse(str));
            });
        });
}
Flickr.prototype.optionToUrl = function(options){
    var url = "";
    for (key in options){
        url += "&" + key + "=" + options[key];
    }
    return url;
}
Flickr.prototype.api = {
    photosets: {
        getList: function(options, callback){
            options.api_key = flickr.api_key;
            Flickr.prototype.request("flickr.photosets.getList", Flickr.prototype.optionToUrl(options), callback);
        },
        getPhotos: function(photoset_id, options, callback){
            options.photoset_id = photoset_id;
            options.api_key = flickr.api_key;
            options.per_page = 50;
            Flickr.prototype.request("flickr.photosets.getPhotos", Flickr.prototype.optionToUrl(options), callback);
        }
    },
    photos: {
        search: function(options, callback){
            options.api_key = flickr.api_key;
            Flickr.prototype.request("flickr.photos.search", Flickr.prototype.optionToUrl(options), callback);
        }
    }
}
var flickr = new Flickr("a2a5ae558fc0a9115e095887f08c084b", "a2e69aaa5f053cad");
module.exports.api = flickr.api;